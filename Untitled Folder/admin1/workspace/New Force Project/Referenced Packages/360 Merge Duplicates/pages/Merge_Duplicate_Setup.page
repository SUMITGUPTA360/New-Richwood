<apex:page controller="tmd.MergeSetupController" sidebar="false">
    <apex:stylesheet value="{!$Resource.tmd__MergeCSS}"/>  
    <apex:stylesheet value="{!$Resource.tmd__MergeDubCSS}"/>  

    <style>
        .text_field{width:240px; height:20px; border:1px solid #b7b3b3; background-color:#fff; margin-top:12px}
        .text_field02{width:150px; height:20px; border:1px solid #b7b3b3; background-color:#fff; margin-top:13px}
        .table1
        {
            width:100%;
            border-collapse:collapse;
        }
        .table1 td,th
        {
            height:30px;           
            border-bottom:1px solid #D6D6D6;
            border-collapse:collapse;
            vertical-align:middle;
            font-size:1.2em
        }
        .seclect_object_main_con
        {
            display:none;
        }
         .error_main_con{ width:100%; height:auto; float:left; padding-bottom:5px}
        .error_con_left{ width:500px; height:auto; float:left;}
        .right_counter_con{width:200px; height:auto; float:right;padding:0 20px 0 0;}
    </style>
    <script>
        function toggle_visibility(e) 
        {
            var x = document.getElementsByClassName("seclect_object_main_con");
            var i;
             for (i = 0; i < x.length; i++) 
             {
                x[i].style.display = 'block';
             }
            x[e].style.display = 'block';
        }
    </script>

    <apex:form id="formId">
    <apex:pageMessages />
        <apex:actionFunction name="Updatelicencekey" action="{!Updatelicencekey}" rerender="formId"/>
        <apex:actionFunction name="editlicencekey" action="{!editlicencekey}"/>

        <div class="main_container">
             <div class="error_main_con">
                <div class="error_con_left">
                 <apex:outputPanel >
                     <apex:image url="{!URLFOR($Resource.tmd__MergeLogo,'Merge_Setting.jpg')}" height="65" style="margin-top:-30px;" />
                 </apex:outputPanel>
                </div>
                
                <div class="right_counter_con">
                    <apex:outputPanel id="totalcount" style="float:right;">
                        <div style="margin-bottom: 2px; font-size: 13px;">
                            Merge Counter
                        </div>
                        <apex:repeat value="{!totalmergedrecords}" var="num" >
                             <span ><apex:image url="{!URLFOR($Resource.tmd__Number,num)}" height="35"/></span>
                        </apex:repeat>
                     </apex:outputPanel>
                </div> 
                <div style="clear:both;"></div>
            </div>
            <div class="step01_main_con">
                <div class="step1_heading">
                    <div class="arrow_con">
                        <a href="" onclick="toggle_visibility(0);">
                            <apex:image url="{!URLFOR($Resource.tmd__Number,'arrow_img.png')}"/>
                        </a>
                    </div>
                    <div class="heading_con">
                        <h1> General Setting</h1>
                    </div>
                </div><!--step1_heading -->
            
                <div class="seclect_object_main_con" style="display:block; width:100%">
                    <div class="top_main_buttons_con">
                        <a href="" onclick="Updatelicencekey();">
                            <apex:image url="{!URLFOR($Resource.tmd__Number,'save2_button.png')}" styleClass="save_img_cls" />
                        </a> 
                        <a href="" onclick="editlicencekey();">
                            <apex:image url="{!URLFOR($Resource.tmd__Number,'edit_button.png')}"/>
                        </a>
                    </div><!--top_main_buttons_con -->
                
                    <table border="0" class="tabletab">
                        <tr>
                            <td><p class="object_cls">No. of Search Records :
                            <span class="helpButton" id="Sectoin-General_Setting-_help">
                                    <img src="/s.gif" class="helpOrb"/>
                                    <script type="text/javascript">
                                        sfdcPage.setHelp('Sectoin-General_Setting', 'Number of searches you want to get done in each go.'); 
                                    </script>
                                </span>
                            </p> </td>
                            <td style="vertical-align: middle; font-size:14px;"> 
                               <!-- <apex:inputText value="{!maxSearchCount}" 
                                                styleClass="text_field" rendered="{!mode=='Edit'}" /> -->
                                <apex:selectList value="{!maxSearchCount}" multiselect="false" size="1" styleClass="text_field" rendered="{!mode=='Edit'}">
                                    <apex:selectOption itemValue="50" itemLabel="50"/>
                                    <apex:selectOption itemValue="100" itemLabel="100"/>
                                    <apex:selectOption itemValue="200" itemLabel="200"/>
                                    <apex:selectOption itemValue="500" itemLabel="500"/>
                                    <apex:selectOption itemValue="1000" itemLabel="1000"/>
                                    <apex:selectOption itemValue="1500" itemLabel="1500"/>
                                    <apex:selectOption itemValue="2000" itemLabel="2000"/>
                                </apex:selectList>
                                <apex:outputText value="{!ROUND(maxSearchCount,0)}" rendered="{!mode=='View'}"/>
                            </td>
                            <td>
                                <p class="object_cls">First "n" letters :
                                    <span class="helpButton" id="Sectoin-General_Setting1-_help">
                                        <img src="/s.gif" class="helpOrb"/>
                                        <script type="text/javascript">
                                            sfdcPage.setHelp('Sectoin-General_Setting1', 'First "n" Letters to Compare Duplicates.'); 
                                        </script>
                                    </span>
                                </p> 
                            </td>
                            <td style="vertical-align: middle; font-size:14px;"> 
                                <apex:inputText value="{!firstNLetters}" 
                                                styleClass="text_field" rendered="{!if(mode=='Edit',true,false)}" />
                                <apex:outputText value="{!ROUND(firstNLetters,0)}" rendered="{!if(mode=='View',true,false)}"/>
                            </td>
                        </tr>
                    </table>
                </div><!-- seclect_object_main_con-->
            </div><!-- step01_main_con-->

            <div class="step01_main_con">
                <div class="step1_heading">
                    <div class="arrow_con02" style="margin-top: 3px;">
    
                        <a href="#!" onclick="toggle_visibility(1);"><apex:image url="{!URLFOR($Resource.tmd__Number,'arrow_img.png')}" /></a>
                    </div>
                    <div class="heading_con">
                        <h1>Delete Criteria</h1>
                    </div>
                </div><!--step1_heading -->
                        
                <div class="seclect_object_main_con" style="display:block;">
                    <apex:actionFunction name="deletecriteria" action="{!deletecriteria}" reRender="deletelist" status="rep_detail_sts" />
                    <table width="1000" border="0">
                        <tr>
                            <td width="257">
                                <p class="object_cls">Delete Saved Criteria
                                </p>
                            </td>
                            <td width="201">
                                <apex:outputPanel id="deletelist">
                                    <apex:selectList value="{!listofselected}" size="6" style="width:200px" multiselect="true">
                                        <apex:selectOptions value="{!select_previous_criteria}"></apex:selectOptions>
                                    </apex:SelectList>
                                </apex:outputPanel>
                            </td>
                            <td width="116" style="padding-top:10px"><apex:image url="{!URLFOR($Resource.tmd__Number,'delete_button.png')}" onclick="deletecriteria();"/></td>
                            <td width="9"></td>
                            <td width="56"></td>
                            <td width="335"></td>
                        </tr>
                    </table>
                    
                </div><!-- seclect_object_main_con-->
            </div><!-- step01_main_con-->


            <div class="step01_main_con">
                <div class="step1_heading">
                    <div class="arrow_con">
                        <a href="#!" onclick="toggle_visibility(2);"><apex:image url="{!URLFOR($Resource.tmd__Number,'arrow_img.png')}"  /></a>
                    </div>
                    <div class="heading_con">
                        <h1> Schedule Criteria</h1>
                    </div>
                </div><!--step1_heading -->
                <apex:outputPanel rendered="{!setupsetting.tmd__Status__c == 'Active' && NOT(isExceedMerges)}">
                    <div class="seclect_object_main_con" style="display:block;">
                        <div class="scheduler_table_con">
                            <apex:actionFunction name="showcriteria" action="{!showcriteria}" reRender="tableshow,errormsg">
                                <apex:param value="" name="Param1" assignTo="{!SN}"/>
                            </apex:actionFunction>
                            
                            <apex:actionFunction name="deletescheduled" action="{!deletescheduled}" reRender="tableshow,errormsg">
                                <apex:param value="" name="Param1" assignTo="{!SN}"/>
                            </apex:actionFunction>
                            
                            <apex:actionFunction name="singlesave" action="{!singlesave}" reRender="tableshow,errormsg">
                                <apex:param value="" name="Param1" assignTo="{!SN}"/>
                            </apex:actionFunction>
                            
                            <apex:actionFunction name="editmode" action="{!editmode}" reRender="tableshow,errormsg">
                                <apex:param value="" name="Param1" assignTo="{!SN}"/>
                            </apex:actionFunction>
                             
                            <apex:actionFunction name="addnew" action="{!addnewrow}" reRender="tableshow,errormsg" />
                            <apex:actionFunction name="saveall" action="{!saveall}" reRender="tableshow,errormsg" />
                            <apex:actionFunction name="deleteall" action="{!deleteall}" reRender="tableshow,errormsg" />
            
                            <div style="width:1095px;height:auto">
                                <div style="width:95%;margin-left:5%">
                                    <table class="table1" style="width:98.25%">
                                        <tr>
                                            <th width="30px">S.N.</th>
                                            <th width="15%" style="text-align:left;">Objects<span style="color:red;font-size:1.4em"><b>*</b>
                                            <span class="helpButton" id="Sectoin-Schedule_Criteria-_help">
                                        <img src="/s.gif" class="helpOrb"/>
                                        <script type="text/javascript">
                                            sfdcPage.setHelp('Sectoin-Schedule_Criteria', 'Select object on which you want to schedule.'); 
                                        </script>
                                    </span>
                                            </span></th>
                                            <th width="20%" style="text-align:center;">Duplicate Criteria<span style="color:red;font-size:1.4em">*
                                            <span class="helpButton" id="Sectoin-Schedule_Criteria1-_help">
                                        <img src="/s.gif" class="helpOrb"/>
                                        <script type="text/javascript">
                                            sfdcPage.setHelp('Sectoin-Schedule_Criteria1', 'Select the Saved Criteria from the drop-down.'); 
                                        </script>
                                    </span>
                                            </span></th>
                                            <th width="15%" style="text-align:center;">Date<span style="color:red;font-size:1.4em">*
                                              <span class="helpButton" id="Sectoin-Schedule_Criteria2-_help">
                                        <img src="/s.gif" class="helpOrb"/>
                                        <script type="text/javascript">
                                            sfdcPage.setHelp('Sectoin-Schedule_Criteria2', 'Select the Date for which you want to schedule criteria and it will run on that Date of every month.'); 
                                        </script>
                                    </span>
                                            </span></th>
                                            <th width="15%" style="text-align:center;">Time<span style="color:red;font-size:1.4em">*
                                            <span class="helpButton" id="Sectoin-Schedule_Criteria3-_help">
                                        <img src="/s.gif" class="helpOrb"/>
                                        <script type="text/javascript">
                                            sfdcPage.setHelp('Sectoin-Schedule_Criteria3', 'Select the Time at which you want to schedule the criteria.'); 
                                        </script>
                                    </span>
                                            </span></th>
                                            <th width="15%">Active
                                            <span class="helpButton" id="Sectoin-Schedule_Criteria4-_help">
                                        <img src="/s.gif" class="helpOrb"/>
                                        <script type="text/javascript">
                                            sfdcPage.setHelp('Sectoin-Schedule_Criteria4', 'Schedule criteria will run only when the Active checkbox is checked.'); 
                                        </script>
                                    </span>
                                            </th>
                                            <th width="117px"><span style="color:red"><span style="color:red;font-size:1.4em">*</span> Mandatory Fields</span></th>
                                        </tr>
                                    </table>
                                    <apex:outputPanel id="tableshow">
                                        <apex:messages id="errormsg" style="color:red;font-size:1.3em" />
                                        <div style="width:100%;height:300px;overflow:scroll">
                                            <table class="table1">   
                                                <apex:repeat value="{!list_show_scheduler}" var="Var1">
                                                    <tr>
                                                        <td width="30px">
                                                            {!Var1.SN+1}
                                                           
                                                        </td>
                                                        <td width="15%">
                                                            <apex:outputPanel rendered="{!if(Var1.type=='View',true,false)}" >{!Var1.sobj.tmd__Sobject__c}</apex:outputPanel>
                                                            <apex:outputPanel rendered="{!if(Var1.type=='Edit',true,false)}" >
                                                                <apex:inputField value="{!Var1.sobj.tmd__Sobject__c}" onchange="showcriteria('{!Var1.SN}')" /> 
                                                            </apex:outputPanel>
                                                        </td>
                                                        <td width="20%">
                                                            <apex:outputPanel rendered="{!if(Var1.type=='View',true,false)}" >{!Var1.sobj.tmd__Duplicate_Criteria__c}</apex:outputPanel>
                                                            <apex:outputPanel rendered="{!if(Var1.type=='Edit',true,false)}" >
                                                                <apex:selectList value="{!Var1.sobj.tmd__Duplicate_Criteria__c}" size="1" style="width:90%">
                                                                    <apex:selectOptions value="{!Var1.selectcriteria}"/>
                                                                </apex:selectList>
                                                            </apex:outputPanel>
                                                        </td>
                                                        <td width="15%" style="text-align:center;">
                                                            <apex:outputPanel rendered="{!if(Var1.type=='View',true,false)}" >{!Var1.sobj.tmd__Month_Day__c}</apex:outputPanel>
                                                            <apex:outputPanel rendered="{!if(Var1.type=='Edit',true,false)}" ><apex:inputField value="{!Var1.sobj.tmd__Month_Day__c}"  /></apex:outputPanel>
                                                        </td>
                                                        <td width="15%" style="text-align:center;">
                                                            <apex:outputPanel rendered="{!if(Var1.type=='View',true,false)}" >{!Var1.sobj.tmd__Time__c}</apex:outputPanel>
                                                            <apex:outputPanel rendered="{!if(Var1.type=='Edit',true,false)}" ><apex:inputField value="{!Var1.sobj.tmd__Time__c}" /></apex:outputPanel>
                                                        </td>
                                                        <td width="15%">
                                                            <apex:outputPanel rendered="{!if(Var1.type=='View',true,false)}" ><apex:outputField value="{!Var1.sobj.Active__c }"/> </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!if(Var1.type=='Edit',true,false)}" ><apex:inputField value="{!Var1.sobj.Active__c }" /></apex:outputPanel>
                                                        </td>
                                                        <td width="117px">
                                                            <apex:outputPanel rendered="{!if(Var1.type=='View',true,false)}" ><a href="#!" onclick="editmode('{!Var1.SN}');"><apex:image url="{!URLFOR($Resource.tmd__Number,'edit_new_image.png')}"  /></a></apex:outputPanel>
                                                            <apex:outputPanel rendered="{!if(Var1.type=='Edit',true,false)}" ><a href="#!" onclick="singlesave('{!Var1.SN}');"><apex:image url="{!URLFOR($Resource.tmd__Number,'save_new_image.png')}"  /></a></apex:outputPanel>
                                                            &nbsp;&nbsp;&nbsp;
                                                            <a href="#!" onclick="deletescheduled('{!Var1.SN}')"><apex:image url="{!URLFOR($Resource.tmd__Number,'delete_new_image.png')}"/></a>
                                                        </td>
                                                    </tr>
                                                </apex:repeat>
                                            </table>
                                        </div>
                                    </apex:outputPanel>
                                </div>
                            </div>
                        </div><!--scheduler_table_con -->
                        <div class="scheduler_button_con">
                            <table width="1000" border="0">
                                <tr>
                                    <td width="129"><a href="#!"><apex:image url="{!URLFOR($Resource.tmd__Number,'add_new.png')}" onclick="addnew();" /></a></td>
                                    <td width="117"><a href="#!"><apex:image url="{!URLFOR($Resource.tmd__Number,'save_all.png')}" onclick="saveall();"/></a></td>
                                    <td width="740"><a href="#!"><apex:image url="{!URLFOR($Resource.tmd__Number,'delete_all.png')}" onclick="deleteall();"/></a></td>
                                </tr>
                            </table>
                        </div><!--scheduler_button_con -->
                    </div><!--app_status_field_main_con -->
                </apex:outputPanel>
                <apex:outputPanel rendered="{!setupsetting.tmd__Status__c != 'Active' || isExceedMerges}">
                    <span style="color: red; font-size: 14px; font-weight:bold;padding-top: 4px;"> Scheduler will not run in Trial mode / Limit exceeded for Merging.</span>
                    
                </apex:outputPanel>
               <!-- <apex:outputPanel rendered="{!setupsetting.Status__c != 'Active' && isExceedMerges}">
                    <span style="color: red; font-size: 14px; font-weight:bold;padding-top: 4px;"> Scheduler will not run while Limit exceeded for Merging.</span>
                    
                </apex:outputPanel>-->
            </div><!-- step01_main_con-->

            <div style="clear:both"></div>
        </div><!--main_container -->
        <div class="line_shadow_con">
        </div><!-- line_shadow_con-->
    </apex:form>
</apex:page>